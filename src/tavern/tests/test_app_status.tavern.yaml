test_name: Test frontend health

strict: False

marks:
  - usefixtures:
      - project_info

stages:
  - name: Check frontend index returns 200
    request:
      url: "{tavern.env_vars.PROJECT_APP_HOST}"
      verify: false
      method: GET
    response:
      status_code: 200

  - name: Get frontend info
    request:
      url: "{tavern.env_vars.PROJECT_APP_HOST}/info"
      verify: false
      method: GET
    response:
      status_code: 200
      save:
        json:
          health: ok

  - name: Check frontend vendor asset returns 200
    request:
      url: "{tavern.env_vars.PROJECT_APP_HOST}/assets/{project_info.version:s}/css/font/FontAwesome.otf"
      verify: false
      method: GET
    response:
      status_code: 200

  - name: Check frontend Helium bundle returns 200
    request:
      url: "{tavern.env_vars.PROJECT_APP_HOST}/assets/{project_info.version:s}/js/base.header.bundle.min.js"
      verify: false
      method: GET
    response:
      status_code: 200

  - name: Check frontend handles not found
    request:
      url: "{tavern.env_vars.PROJECT_APP_HOST}/a-fake-page"
      verify: false
      method: GET
    response:
      status_code: 404
